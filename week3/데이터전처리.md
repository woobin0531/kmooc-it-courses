# Week 03 – 데이터 전처리 (결측치, 이상치, 구간화)

## 📌 학습 목표

- 데이터 전처리 개념과 필요성 이해
- 결측치 및 이상치 처리 방법 실습
- 데이터 구간화(Binning)를 활용한 Feature Engineering 기초 습득

---

## 🧹 데이터 전처리란?

> **AI 모델링 전, 수집된 데이터를 정제하고 다듬는 과정**

- 모델 성능 향상과 정확한 분석을 위해 필수
- 실무에서 가장 많은 시간 투자 필요 (80% 이상 소요되는 경우도 있음)

---

## ❗ 결측치(Missing Value) 처리

### 📌 결측치란?

- 데이터 값이 존재하지 않는 상태 (`NaN`, `Null`, `N/A` 등)
- 반드시 처리해야 분석 및 모델 학습 가능

---

### 🔸 결측치 제거 방법

| 방법     | 설명                                            | 예시                         |
| -------- | ----------------------------------------------- | ---------------------------- |
| Listwise | 결측치가 있는 **전체 행 삭제**                  | `df.dropna()`                |
| Pairwise | 일부 결측값은 유지하고, **완전 결측 행만 삭제** | 분석 변수에 따라 유동적 적용 |

> Listwise는 데이터 손실이 크기 때문에 신중하게 사용

---

### 🔸 결측치 대체 방법

| 방법   | 설명                         | Pandas 예시                    |
| ------ | ---------------------------- | ------------------------------ |
| 평균값 | `mean()` 사용                | `df.fillna(df.mean())`         |
| 중앙값 | `median()` 사용              | `df.fillna(df.median())`       |
| 최빈값 | `mode()` 사용                | `df.fillna(df.mode().iloc[0])` |
| 보간법 | 이전/다음 값을 기반으로 예측 | `df.interpolate()`             |

---

### 🔸 예시

```python
# 결측치 평균으로 채우기
df['column'] = df['column'].fillna(df['column'].mean())

# 보간법
df['column'] = df['column'].interpolate()

# 결측치 제거
df = df.dropna()
```

---

## 📉 이상치(Outlier) 처리

### 📌 이상치란?

- **일반적인 범주에서 크게 벗어난 값**
- 평균, 분포, 모델 성능에 부정적 영향

### 🔍 이상치 탐지 방법

- Boxplot, 산점도, IQR 기준 사용

```python
# IQR 기준 이상치 탐지
Q1 = df['column'].quantile(0.25)
Q3 = df['column'].quantile(0.75)
IQR = Q3 - Q1

lower = Q1 - 1.5 * IQR
upper = Q3 + 1.5 * IQR

outliers = df[(df['column'] < lower) | (df['column'] > upper)]
```

---

### 🔄 이상치 처리 방법

| 방법 | 설명                               |
| ---- | ---------------------------------- |
| 제거 | 이상치가 명백한 오류일 경우        |
| 대체 | 다른 값으로 바꿈 (평균, 중앙값 등) |
| 변환 | 로그 변환, 제곱근 등으로 분포 조정 |

---

## 📦 구간화 (Binning)

### 📌 정의

- **연속형 변수 → 범주형 변수로 변환**
- 데이터 해석력을 높이고, 분포 불균형을 개선할 수 있음

### 🔸 예시

```python
# 나이 구간화 예시
bins = [0, 20, 40, 60, 100]
labels = ['청소년', '청년', '중년', '노년']
df['age_group'] = pd.cut(df['age'], bins=bins, labels=labels)
```

---

## ✅ 핵심 정리

| 항목        | 설명                             |
| ----------- | -------------------------------- |
| 결측치 제거 | `dropna()` / Listwise, Pairwise  |
| 결측치 대체 | `fillna()`, `interpolate()` 등   |
| 이상치 탐지 | Boxplot, IQR 기반                |
| 이상치 처리 | 제거, 대체, 변환 (log 등)        |
| 구간화      | 연속형 → 범주형, `pd.cut()` 활용 |

---

## 💡 실전 팁

- 결측치는 무조건 제거보단 **적절한 대체**가 중요
- 이상치는 시각화와 수치 기준 모두 고려해 판단
- 구간화는 모델 정확도를 높이는 **Feature Engineering** 핵심 기법 중 하나
